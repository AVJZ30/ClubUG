<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nuestra Comunidad - Club UG</title>
<link rel="icon" href="https://raw.githubusercontent.com/LUISPLUAAAA/index.html/main/favicon-32x32.png" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root{
    --bg-1:#020218;
    --bg-2:#001f3f;
    --card: rgba(255,255,255,0.03);
    --neon-a:#00e6ff;
    --neon-b:#0066ff;
    --accent:#00ffd6;
    --text:#dff6ff;
    --muted:#9fcfe8;
    --shadow:0 18px 60px rgba(0,0,0,0.6);
    --radius:14px;
    --gap:20px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{
    font-family:'Poppins',system-ui,-apple-system,'Segoe UI',Roboto,Arial;
    background:
      radial-gradient(900px 400px at 10% 10%, rgba(0,110,255,0.06), transparent 8%),
      linear-gradient(180deg,var(--bg-1) 0%, var(--bg-2) 65%);
    color:var(--text);
    display:flex;
    align-items:flex-start;
    justify-content:center;
    padding:28px;
  }

  /* Layout: stacked (message arriba, calendario abajo) */
  .container {
    width:100%;
    max-width:1100px;
    display:flex;
    flex-direction:column;
    gap:20px;
  }

  .header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .brand { display:flex; align-items:center; gap:12px; }
  .logo { width:56px; height:56px; border-radius:12px; background:linear-gradient(135deg,var(--neon-a),var(--neon-b)); display:flex; align-items:center; justify-content:center; font-weight:800; color:#00121a }
  .title h1 { font-size:1.05rem; margin:0 }
  .title p { margin:2px 0 0; color:var(--muted); font-size:0.86rem }

  /* Message box (arriba) */
  .today-card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:18px;
    border-radius:var(--radius);
    box-shadow: var(--shadow);
    border:1px solid rgba(0,120,255,0.06);
    display:flex;
    gap:18px;
    align-items:center;
    justify-content:space-between;
  }
  .left {
    min-width:0;
  }
  .label { color:var(--neon-a); font-weight:700; margin-bottom:8px }
  .main-text { font-size:1.05rem; font-weight:700; margin-bottom:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
  .desc { color:var(--muted) }

  .avatar {
    width:96px; height:96px; border-radius:12px; background:linear-gradient(135deg,var(--neon-a),var(--neon-b)); display:flex;align-items:center;justify-content:center;font-weight:900;color:#00121a;
    box-shadow:0 14px 48px rgba(0,64,255,0.08);
    flex-shrink:0;
  }

  .today-actions { display:flex; gap:10px; align-items:center; }
  .btn {
    border:0; padding:10px 14px; border-radius:10px; cursor:pointer;
    background: linear-gradient(90deg,var(--neon-a),var(--neon-b));
    color:#00121a; font-weight:700; box-shadow: 0 12px 36px rgba(0,64,255,0.09);
  }
  .btn.ghost { background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.03) }

  /* Calendar area (debajo) */
  .calendar-wrapper {
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));
    padding:16px;
    border-radius:var(--radius);
    border:1px solid rgba(255,255,255,0.02);
    box-shadow: 0 14px 40px rgba(0,0,0,0.6);
    transition: transform .36s cubic-bezier(.2,.9,.2,1), box-shadow .36s;
    overflow: hidden;
  }

  /* When expanded (clicked) increase padding and shadow */
  .calendar-wrapper.expanded {
    transform: translateY(-6px) scale(1.01);
    box-shadow: 0 28px 90px rgba(0,0,0,0.72);
  }

  .calendar-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; gap:12px }
  .month-title { font-weight:800; color:var(--neon-a); font-size:1.02rem }
  .navs { display:flex; gap:8px; align-items:center }

  .weeknames { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; color:var(--muted); font-size:0.78rem; text-align:center; margin-bottom:10px }
  .days {
    display:grid;
    grid-template-columns:repeat(7,1fr);
    gap:12px;
    transition: all .28s ease;
  }

  /* each day tile */
  .day {
    min-height:92px;
    border-radius:12px;
    padding:10px;
    background: rgba(255,255,255,0.012);
    color:var(--text);
    position:relative;
    font-size:0.92rem;
    display:flex;
    flex-direction:column;
    gap:8px;
    transition: transform .18s cubic-bezier(.2,.9,.2,1), box-shadow .18s, background .18s;
    cursor:pointer;
  }
  .day:hover { transform: translateY(-6px); box-shadow: 0 18px 40px rgba(0,0,0,0.6) }
  .num { font-weight:800; color:#eafcff; font-size:0.95rem }
  .names { font-size:0.78rem; color:var(--muted); line-height:1.05; max-height:3.6em; overflow:hidden; white-space:normal }
  .dot { position:absolute; left:10px; bottom:10px; width:12px;height:12px;border-radius:50%; background:linear-gradient(90deg,var(--neon-a),var(--neon-b)); box-shadow:0 12px 30px rgba(0,120,255,0.12) }

  /* better spacing on mobile (stack days into fewer rows visually by increasing gap) */
  @media (max-width:900px){
    .day{ min-height:78px; padding:8px }
    .days{ gap:10px }
  }
  @media (max-width:640px){
    .days{ gap:8px }
    .day{ min-height:64px; border-radius:10px }
    .avatar{ width:72px; height:72px }
  }

  /* small helper highlight for quick view */
  .glow-highlight { animation: highlightIn .9s cubic-bezier(.2,.9,.2,1) both; }
  @keyframes highlightIn {
    0%{ box-shadow:0 0 0 rgba(0,0,0,0); border-color: rgba(0,230,255,0); }
    100%{ box-shadow:0 18px 60px rgba(0,110,255,0.06); border-color: rgba(0,230,255,0.08); }
  }

  /* popup & confetti similar to previous */
  .birthday-popup {
    position:fixed; left:50%; top:14%; transform:translateX(-50%); z-index:1001;
    background:linear-gradient(180deg, rgba(0,18,40,0.98), rgba(0,0,0,0.92)); border-radius:12px; padding:16px 20px;
    border:1px solid rgba(0,230,255,0.08); box-shadow:0 30px 100px rgba(0,0,0,0.75); width:fit-content; max-width:92%; text-align:center; color:var(--text);
    animation: popupIn .7s cubic-bezier(.2,.9,.2,1) both;
  }
  .popup-h1 { font-weight:900; color:var(--neon-a); margin-bottom:6px; font-size:1.15rem }
  .popup-sub { color:var(--muted); font-size:0.95rem }
  .confetti { position:fixed; pointer-events:none; z-index:1000; border-radius:3px; opacity:0.95 }
</style>
</head>
<body>
  <div class="container">

    <div class="header">
      <div class="brand">
        <div class="logo">UG</div>
        <div class="title">
          <h1>Nuestra Comunidad</h1>
          <p>Club UG ‚Äî Celebramos a nuestra gente</p>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <button class="btn" id="goToTodayTop"><i class="fas fa-calendar-day"></i>&nbsp; Hoy</button>
        <button class="btn ghost" id="openCalendarTop"><i class="fas fa-calendar-alt"></i>&nbsp; Ver calendario</button>
      </div>
    </div>

    <!-- Mensaje principal arriba -->
    <div class="today-card" role="region" aria-label="Hoy">
      <div class="left">
        <div class="label">Hoy</div>
        <div id="contentBox">
          <div class="main-text" style="color:var(--muted)">Esperando los pr√≥ximos cumplea√±os...</div>
        </div>
        <div class="desc" id="subBox">Explora el calendario para ver qui√©n cumple</div>
      </div>

      <div style="display:flex;flex-direction:column;gap:12px;align-items:flex-end">
        <div class="avatar" id="todayAvatar">üéà</div>
        <div style="display:flex;gap:8px">
          <button class="btn" id="openCalendar">Ver calendario</button>
          <button class="btn ghost" id="backPrincipal" onclick="location.href='index.html'"><i class="fas fa-home"></i>&nbsp; Principal</button>
        </div>
      </div>
    </div>

    <!-- Calendario (ABAJO, ancho completo) -->
    <div id="calendarArea" class="calendar-wrapper" aria-live="polite">
      <div class="calendar-header">
        <div>
          <div style="font-size:.85rem;color:var(--muted)">Calendario</div>
          <div class="month-title" id="miniMonth"></div>
        </div>
        <div class="navs">
          <button class="btn ghost" id="prevMonth"><i class="fas fa-chevron-left"></i></button>
          <button class="btn ghost" id="nextMonth"><i class="fas fa-chevron-right"></i></button>
        </div>
      </div>

      <div class="weeknames">
        <div>Lun</div><div>Mar</div><div>Mi√©</div><div>Jue</div><div>Vie</div><div>S√°b</div><div>Dom</div>
      </div>

      <div class="days" id="daysGrid" role="grid" aria-label="dias del mes"></div>
    </div>

  </div>

  <audio id="applause" src="https://www.soundjay.com/human/sounds/applause-8.mp3" preload="auto"></audio>
  <div id="modalRoot" style="display:none"></div>

<script>
/* Datos (igual que antes) */
const usuarios = [
{ nombre: "Kavier", carrera: "Fan de la UG", fecha: "31/08/2005" },
{ nombre: "Miranda Danna", carrera: "Contabilidad y auditor√≠a", fecha: "29/08/2005" },
{ nombre: "Campuzano Benavides Amelia Elizabeth", carrera: "Ingenier√≠a civil", fecha: "25/08/1996" },
{ nombre: "Baja√±a Aviles Deivid Alexander", carrera: "Comercio exterior", fecha: "29/07/2007" },
{ nombre: "Mendoza Zambrano Thaylor Enrique", carrera: "Sociolog√≠a", fecha: "30/10/2001" },
{ nombre: "Luis Antonio Mite Contreras", carrera: "Derecho", fecha: "10/04/2006" },
{ nombre: "AMAT BRIONES MAYKELL GONZALO", carrera: "Sistemas de Informaci√≥n", fecha: "10/06/2006" },
{ nombre: "Raquel Macias", carrera: "Medicina", fecha: "04/04/2007" },
{ nombre: "Yanez Orellana Silvia Narcisa", carrera: "Terapia Ocupacional", fecha: "13/07/2007" },
{ nombre: "Bravo Calvas Rober Gabriel", carrera: "Agronom√≠a", fecha: "19/08/2004" },
{ nombre: "RAMIREZ PUCHAICELA JEREMY GABRIEL", carrera: "Pedagog√≠a de la actividad f√≠sica y deporte", fecha: "12/01/2007" },
{ nombre: "Ortega Vera Alexander Israel", carrera: "Comunicaci√≥n", fecha: "04/07/2006" },
{ nombre: "QUIJIJE ZAMBRANO ASHLEY PAULETTE", carrera: "Econom√≠a", fecha: "21/09/2007" },
{ nombre: "Coronado Ch√≥ez Kenya Sabrina", carrera: "Pedagog√≠a de las ciencias experimentales", fecha: "10/02/2006" },
{ nombre: "Molina Camba Dallyana Victoria", carrera: "Ingenier√≠a qu√≠mica", fecha: "10/09/2007" },
{ nombre: "Zharick Hern√°ndez", carrera: "Negocios Internacionales", fecha: "11/09/2005" },
{ nombre: "Romero Pacheco Carlos Jeampierre", carrera: "Ingenier√≠a en Ciencias de Datos e Inteligencia Artificial", fecha: "05/05/2007" },
{ nombre: "Danny Tomal√°", carrera: "Ingenier√≠a qu√≠mica", fecha: "02/10/2002" },
{ nombre: "Franco Nu√±ez Alinson Dominic", carrera: "Terapia respiratoria", fecha: "21/06/2007" },
{ nombre: "LE√ìN ORD√ì√ëEZ SAMANTHA ISABELA", carrera: "Pedagog√≠a de la lengua y literatura", fecha: "05/11/2006" },
{ nombre: "Luisa Chacha Melanny Akanne", carrera: "Comunicaci√≥n", fecha: "20/02/2005" },
{ nombre: "Plaza Matute Amelia Alejandra", carrera: "Educaci√≥n b√°sica", fecha: "02/09/2004" },
{ nombre: "Medina Cordova Karla Amelia", carrera: "Derecho", fecha: "11/11/2007" },
{ nombre: "Beatriz Vanessa Quiroga V√°squez", carrera: "Pedagog√≠a de Historia y Ciencias Sociales", fecha: "29/08/1996" },
{ nombre: "Oliveyra V√°squez Angel Gabriel", carrera: "Comunicaci√≥n Social", fecha: "04/03/2005" },
{ nombre: "Heydi barrera", carrera: "Comunicaci√≥n", fecha: "30/07/2002" },
{ nombre: "Pilalo Villarroel Joseline Isabel", carrera: "Enfermer√≠a", fecha: "30/05/2007" },
{ nombre: "Le√≥n Freire Crista Sharik", carrera: "Derecho", fecha: "04/12/2005" },
{ nombre: "Palma Martinez Tylor Alberto", carrera: "Ingenier√≠a qu√≠mica", fecha: "29/07/2006" },
{ nombre: "Carvajal Acosta Ariel Alejandro", carrera: "Comunicaci√≥n social", fecha: "13/02/2004" },
{ nombre: "Lilibeth Guzm√°n", carrera: "Ingenier√≠a en Sistemas", fecha: "19/10/2007" },
{ nombre: "Barzola Torres Ingrid Del Roc√≠o", carrera: "Ingenier√≠a Qu√≠mica", fecha: "28/02/2007" },
{ nombre: "Santos Mora Adriana Georgette", carrera: "Psicolog√≠a", fecha: "13/11/2005" },
{ nombre: "Guevara Villamar Milena Tahis", carrera: "Comunicaci√≥n social", fecha: "13/06/2001" },
{ nombre: "Mayra Navarro", carrera: "Gastronom√≠a", fecha: "07/02/2007" },
{ nombre: "Rodriguez Ayovi Arlette Naomi", carrera: "Mercadotecnia", fecha: "06/05/2007" },
{ nombre: "Taday Medina Mar√≠a Fernanda", carrera: "Medicina", fecha: "14/05/2007" },
{ nombre: "V√©lez Zambrano Mar√≠a Jos√©", carrera: "Econom√≠a", fecha: "11/01/2007" },
{ nombre: "Vargas Mesias Narcisa Paulina", carrera: "Medicina veterinaria y zootecnia", fecha: "30/05/2007" },
{ nombre: "Moreno Beltr√°n Christian Sleyner", carrera: "Agronom√≠a", fecha: "08/10/2007" },
{ nombre: "Le√≥n Alvarado Juliana Scarlett", carrera: "Educaci√≥n B√°sica", fecha: "31/05/2007" },
{ nombre: "AYORA ZAMBRANO FABIAN ALEJANDRO", carrera: "Pedagog√≠a de las ciencias experimentales-Informatica", fecha: "14/08/2007" },
{ nombre: "Yance Henrry Adri√°n", carrera: "Derecho", fecha: "27/02/2007" },
{ nombre: "Palma Cornejo Elena Alejandra", carrera: "Comunicaci√≥n social", fecha: "01/06/2005" },
{ nombre: "Moreira vone Aaron Abraham", carrera: "Pedagog√≠a de Qu√≠mica y Biolog√≠a", fecha: "13/08/2004" },
{ nombre: "Alonso Rodr√≠guez Mar√≠a Alejandra", carrera: "Pedagog√≠a de historia", fecha: "02/03/2002" },
{ nombre: "Tixe Castro Brithany Gabriela", carrera: "Educaci√≥n B√°sica", fecha: "13/01/2007" },
{ nombre: "Mu√±oz Arana Anneliz Esther", carrera: "Terapia Ocupacional", fecha: "28/09/2005" },
{ nombre: "Arias Anzoategui Keissy", carrera: "Pedagog√≠a en la Lengua y Literatura", fecha: "08/05/2002" },
{ nombre: "Drake Hunter Zolomon Addams", carrera: "Sistemas de formaci√≥n", fecha: "15/01/1993" },
{ nombre: "Troya Rodr√≠guez Valeria Paulette", carrera: "Odontolog√≠a", fecha: "17/09/2005" },
{ nombre: "Medranda Merch√°n Wilmer Adalberto", carrera: "Educaci√≥n b√°sica", fecha: "03/08/2003" },
{ nombre: "Triana Gamarra Rosmery Alejandra", carrera: "Ingenier√≠a Qu√≠mica", fecha: "06/04/2008" },
{ nombre: "Sasha Vinasco", carrera: "Pedagog√≠a en las ciencias experimentales de la qu√≠mica y Biolog√≠a", fecha: "04/02/2006" },
{ nombre: "Cevallos Kayla", carrera: "Pedagog√≠a en artes y humanidades", fecha: "08/11/2001" },
{ nombre: "Isa√≠as David Vitores", carrera: "Sistemas de Informaci√≥n", fecha: "12/08/2001" },
{ nombre: "Melany Gutierrez Cajape", carrera: "Medicina Veterinaria y Zootecnia", fecha: "23/10/2006" },
{ nombre: "CHIRIGUAYO Garc√≠a Bryan Alexander", carrera: "Psicol√≥gica", fecha: "25/09/2003" },
{ nombre: "MALO SANTILL√ÅN LIZ ESTHELA", carrera: "Comunicaci√≥n Social", fecha: "14/10/2005" },
{ nombre: "VILLAMAR ROSALES BRYAN SAMIR", carrera: "Negocios internacionales", fecha: "05/12/2006" },
{ nombre: "Frank Jahir Posligua Manrique", carrera: "Gastronom√≠a", fecha: "07/07/2006" },
{ nombre: "Carriel Lorenti Bryan Xavier", carrera: "Pedagog√≠a de la Lengua y Literatura", fecha: "08/11/2006" },
{ nombre: "D√©bora Guaigua", carrera: "Pedagog√≠a en idiomas", fecha: "16/09/2005" },
{ nombre: "Lamota Soriano Giuliana Scarlett", carrera: "Educaci√≥n inicial", fecha: "13/02/2007" },
{ nombre: "Crespo Chiquito Domenica Ayleen", carrera: "Telem√°tica", fecha: "02/10/2005" },
{ nombre: "Moncada Espinoza Adolfo Jefferson", carrera: "Educaci√≥n b√°sica", fecha: "30/09/1992" },
{ nombre: "Romero Barahona L√≠a Dayana", carrera: "Pedagog√≠a de matem√°ticas y f√≠sica", fecha: "20/10/2007" },
{ nombre: "Suplewiche Cede√±o Noelia Dayana", carrera: "Contabilidad y auditor√≠a", fecha: "28/10/2007" },
{ nombre: "Lucin Alava Juli√°n Isaac", carrera: "Telem√°tica", fecha: "13/03/2007" },
{ nombre: "Tenesaca Cepeda Nahin Isaias", carrera: "Comunicaci√≥n Social", fecha: "02/04/2004" },
{ nombre: "Barcos Tumbaco Aar√≥n Alexander", carrera: "Sistemas de la Informaci√≥n", fecha: "20/03/2005" },
{ nombre: "Jimenez Sanchez brithany Anailen", carrera: "Finanzas", fecha: "07/12/2006" },
{ nombre: "Mindiolaza Canto Cristopher Stalin", carrera: "Educaci√≥n B√°sica", fecha: "27/11/2001" },
{ nombre: "PILAMUNGA FLORES DOMENICA MABEL", carrera: "BIOQU√çMICA Y FARMACIA", fecha: "02/04/2007" },
{ nombre: "MEJ√çA MORA JOSELYN JAMILETH", carrera: "Pedagog√≠a de matem√°ticas y f√≠sica", fecha: "09/10/2005" },
{ nombre: "Castro Carla", carrera: "Gesti√≥n de la Informaci√≥n Gerencial", fecha: "07/12/2002" },
{ nombre: "Navarrete Avelino Jose Luis", carrera: "Finanzas", fecha: "07/09/2005" },
{ nombre: "Ru√≠z Mu√±oz Bianca Nayeli", carrera: "Ingenier√≠a en alimentos", fecha: "24/10/2005" },
{ nombre: "Salinas Guam√°n Francheska Marisol", carrera: "Educaci√≥n B√°sica", fecha: "11/10/2007" },
{ nombre: "Yerexi Ginneth Matia Ayovi", carrera: "Pedagog√≠a idiomas extranjeros y nacionales", fecha: "26/06/2007" },
{ nombre: "Silva Castro Rosa Nathalia", carrera: "Software", fecha: "07/03/2007" }
];

/* utilidades fecha */
function parseFlexibleDate(s){
  if(!s) return null;
  s = s.toString().trim();
  const dmY = s.match(/^(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})$/);
  if(dmY){ let d=+dmY[1], m=+dmY[2], y=+dmY[3]; if(y<100) y+=1900; return new Date(y,m-1,d); }
  const ymd = s.match(/^(\d{4})[\/\-](\d{1,2})[\/\-](\d{1,2})$/);
  if(ymd) return new Date(+ymd[1],+ymd[2]-1,+ymd[3]);
  const dd = new Date(s); return isNaN(dd.getTime())? null : dd;
}
function calcularEdad(fecha){
  if(!fecha) return null;
  const hoy = new Date();
  let edad = hoy.getFullYear() - fecha.getFullYear();
  const m = hoy.getMonth() - fecha.getMonth();
  if(m < 0 || (m === 0 && hoy.getDate() < fecha.getDate())) edad--;
  return edad >= 0 ? edad : null;
}
function escapeHtml(s){ return (s+'').replace(/[&<>"]/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])) }
function mesNombre(m){ return ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'][m] || '' }

/* preparar datos */
const hoy = new Date();
usuarios.forEach(u=>{
  const p = parseFlexibleDate(u.fecha);
  u._parsed = p;
  if(p){ u._day = p.getDate(); u._month = p.getMonth()+1; }
});

const todayDay = hoy.getDate(), todayMonth = hoy.getMonth()+1;
const cumpleHoy = usuarios.filter(u => u._day === todayDay && u._month === todayMonth);

/* refs */
const contentBox = document.getElementById('contentBox');
const subBox = document.getElementById('subBox');
const todayAvatar = document.getElementById('todayAvatar');
const daysGrid = document.getElementById('daysGrid');
const miniMonth = document.getElementById('miniMonth');
const calendarArea = document.getElementById('calendarArea');

/* mostrar mensaje principal */
function showMainBirthday(list){
  if(!list || list.length===0){
    contentBox.innerHTML = `<div style="color:var(--muted)">Esperando los pr√≥ximos cumplea√±os...</div>`;
    todayAvatar.textContent = 'üéà';
    subBox.textContent = 'Explora el calendario para ver qui√©n cumple';
    return;
  }
  const u = list[0];
  const edad = calcularEdad(u._parsed);
  contentBox.innerHTML = `<div style="font-weight:800">${escapeHtml(u.nombre)}</div>
                          <div style="color:var(--muted);margin-top:6px">${escapeHtml(u.carrera)} ${edad!==null?('¬∑ '+edad+' a√±os'):''}</div>
                          <div style="margin-top:10px;color:var(--text)"><strong>¬°Feliz cumplea√±os!</strong> üéâ Club UG te manda un abrazo</div>`;
  todayAvatar.textContent = (u.nombre.split(' ').map(t=>t[0]).slice(0,2).join('') || 'UG').toUpperCase();
  subBox.textContent = '¬°Feliz cumplea√±os! üéà';
}

/* confetti y popup */
function createConfettiBurst(){
  const colors = ['#00e6ff','#0066ff','#ffffff','#00ffd6','#ffea66'];
  for(let i=0;i<50;i++){
    const el = document.createElement('div');
    el.className = 'confetti';
    const w = Math.random()*10+6;
    el.style.width = w+'px'; el.style.height = (w*0.55)+'px';
    el.style.left = Math.random()*100+'vw';
    el.style.top = (-Math.random()*18)+'vh';
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.transform = `rotate(${Math.random()*360}deg)`;
    document.body.appendChild(el);
    const t = 1500 + Math.random()*2000;
    el.animate([{transform:el.style.transform, opacity:1},{transform:`translateY(${80+Math.random()*60}vh) rotate(${Math.random()*1440}deg)`, opacity:0.1}], { duration: t, easing: 'cubic-bezier(.2,.7,.2,1)' });
    setTimeout(()=>el.remove(), t+60);
  }
}
function showBirthdayPopup(u){
  const edad = calcularEdad(u._parsed);
  const popup = document.createElement('div');
  popup.className = 'birthday-popup';
  popup.innerHTML = `<div class="popup-h1">üéâ ¬°Feliz Cumplea√±os ${escapeHtml(u.nombre)}! üéâ</div>
                     <div class="popup-sub">${escapeHtml(u.carrera)} ${edad?('¬∑ '+edad+' a√±os'):''}<br>Club UG te manda un abrazo ü§ó</div>`;
  document.body.appendChild(popup);
  const audio = document.getElementById('applause');
  if(audio){ audio.currentTime = 0; audio.play().catch(()=>{}) }
  createConfettiBurst();
  setTimeout(()=> popup.remove(), 4200);
  if("Notification" in window && Notification.permission === "default"){
    Notification.requestPermission().catch(()=>{});
  } else if("Notification" in window && Notification.permission === "granted"){
    new Notification(`üéâ ${u.nombre} cumple hoy!`, { body: `Carrera: ${u.carrera}` });
  }
}

/* render calendario */
let calYear = hoy.getFullYear();
let calMonth = hoy.getMonth(); // 0-based

function renderCalendar(year, month){
  daysGrid.innerHTML = '';
  miniMonth.textContent = `${mesNombre(month)} ${year}`;
  const firstDay = new Date(year, month, 1);
  const startWeekDay = (firstDay.getDay() + 6) % 7; // lunes=0
  const daysInMonth = new Date(year, month+1, 0).getDate();

  for(let i=0;i<startWeekDay;i++){
    const empty = document.createElement('div'); empty.className='day'; empty.style.opacity='0.03'; empty.style.pointerEvents='none';
    daysGrid.appendChild(empty);
  }

  for(let d=1; d<=daysInMonth; d++){
    const cell = document.createElement('div'); cell.className='day'; cell.tabIndex = 0;
    const num = document.createElement('div'); num.className='num'; num.textContent = d;
    cell.appendChild(num);

    const found = usuarios.filter(u => u._day === d && u._month === (month+1));
    if(found.length){
      const names = document.createElement('div'); names.className='names';
      names.innerHTML = found.slice(0,4).map(x => escapeHtml(x.nombre)).join('<br>');
      cell.appendChild(names);
      const dot = document.createElement('div'); dot.className = 'dot'; cell.appendChild(dot);
      cell.classList.add('has-bday');
    } else {
      const filler = document.createElement('div'); filler.style.flex='1'; cell.appendChild(filler);
    }

    cell.addEventListener('click', ()=> openDayList(d, month));
    cell.addEventListener('keydown', (e)=>{ if(e.key==='Enter') openDayList(d, month) });

    daysGrid.appendChild(cell);
  }

  // subtle reflow animation (bounce)
  daysGrid.style.opacity = 0; daysGrid.style.transform = 'translateY(8px)';
  setTimeout(()=>{ daysGrid.style.transition='all .36s ease'; daysGrid.style.opacity=1; daysGrid.style.transform='translateY(0)'; }, 10);
}

/* abrir lista del d√≠a: en vez de alert, mostramos popup centrado y grande */
function openDayList(day, monthZeroBased){
  const list = usuarios.filter(u => u._day === day && u._month === (monthZeroBased+1));
  if(!list.length){
    // peque√±o toast
    const t = document.createElement('div'); t.className='birthday-popup'; t.style.top='auto'; t.style.bottom='6%';
    t.innerHTML = `<div style="color:var(--muted)">${day} de ${mesNombre(monthZeroBased)} ‚Äî No hay cumplea√±os</div>`;
    document.body.appendChild(t); setTimeout(()=> t.remove(), 1400);
    return;
  }

  // construir modal content simple y limpio
  const modal = document.createElement('div'); modal.className='birthday-popup';
  let html = `<div class="popup-h1">Cumplea√±os ‚Äî ${day} ${mesNombre(monthZeroBased)}</div>`;
  html += '<div style="text-align:left;margin-top:8px">';
  list.forEach(u=>{
    const edad = calcularEdad(u._parsed);
    html += `<div style="margin-bottom:10px"><strong>${escapeHtml(u.nombre)}</strong><div style="color:var(--muted);font-size:.9rem">${escapeHtml(u.carrera)} ${edad?('¬∑ '+edad+' a√±os'):''}</div></div>`;
  });
  html += `</div><div style="margin-top:10px;text-align:right"><button class="btn ghost closeModal">Cerrar</button></div>`;
  modal.innerHTML = html;
  document.body.appendChild(modal);

  // handler cerrar
  modal.querySelector('.closeModal').addEventListener('click', ()=> modal.remove());
}

/* controles */
document.getElementById('prevMonth').addEventListener('click', ()=> { calMonth--; if(calMonth<0){ calMonth=11; calYear-- } renderCalendar(calYear, calMonth); });
document.getElementById('nextMonth').addEventListener('click', ()=> { calMonth++; if(calMonth>11){ calMonth=0; calYear++ } renderCalendar(calYear, calMonth); });

function expandCalendarThenScroll(){
  calendarArea.classList.add('expanded','glow-highlight');
  // remove highlight class after animation
  setTimeout(()=> calendarArea.classList.remove('glow-highlight'), 900);
  calendarArea.scrollIntoView({behavior:'smooth', block:'center'});
}

/* botones ver calendario */
document.getElementById('openCalendar').addEventListener('click', ()=> expandCalendarThenScroll());
document.getElementById('openCalendarTop').addEventListener('click', ()=> expandCalendarThenScroll());
document.getElementById('goToTodayTop').addEventListener('click', ()=> {
  calYear = hoy.getFullYear(); calMonth = hoy.getMonth(); renderCalendar(calYear, calMonth);
  expandCalendarThenScroll();
});

/* inicializar */
renderCalendar(calYear, calMonth);
showMainBirthday(cumpleHoy);

/* si hay cumple hoy, popup y sonido */
if(cumpleHoy && cumpleHoy.length>0){
  setTimeout(()=> showBirthdayPopup(cumpleHoy[0]), 300);
}

/* pedir permiso notificaciones */
if("Notification" in window && Notification.permission === "default"){
  setTimeout(()=> Notification.requestPermission().catch(()=>{}), 1800);
}

/* cerrar popup con ESC */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Escape'){
    document.querySelectorAll('.birthday-popup').forEach(p=>p.remove());
  }
});
</script>
</body>
</html>




